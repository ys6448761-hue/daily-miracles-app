# CODE 작업지시서: 2026 섬박람회 "소원비행기 × 디지털 용궁 보관" MVP

> **승인일**: 2026-02-01
> **발신**: 루미 (Aurora5 제작실 / Data Analyst & Tech Spec)
> **승인**: 푸르미르 CEO
> **수신**: Claude Code
> **우선순위**: 🔴 높음 (행사형 서비스: 안정성 최우선)

---

## 핵심 결정

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
   ✅ 결론: "소원비행기"로만 간다. 아날로그 폴백 전면 폐기.
   현장 2~3분 내 "보관 완료 체감" + 귀가 후 "용궁 선물" 자동 제공
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

---

## 0) 핵심 목표

* 박람회 현장에서 방문객이 **2~3분 내 즉시 결과물**을 받는다.
* 운영 인력 **0~1명**으로도 굴러가야 한다.
* 세계관은 **"소원비행기 → 디지털 용궁 보관"**으로 마무리되고, 이후 서비스 이용으로 자연스럽게 이어진다.

---

## 1) 사용자 경험(UX) 최종 플로우 (MVP)

### A. 현장 즉시(필수) — "용궁 보관 완료 + 보관증 발급"

1. QR 스캔 → **'소원비행기 발사 게이트'** 페이지 진입
2. 입력: 소원 한 줄(20자 권장, 최대 n자) + 사진 1장(선택, 최대 3장)
3. 버튼: **[소원비행기 보내기 ✈️]**
4. 3~10초 애니메이션(비행기 비행/진행바)
5. 결과: **'용궁 보관증(이미지)' 즉시 발급 + 개인 '디지털 용궁 보관함' 링크(또는 QR)**
6. 공유 버튼: 카톡/인스타 등

> "탑승권" 용어 사용 금지. 반드시 **보관/봉인/도착** 톤으로.

### B. 귀가 후(필수) — "용궁에서 온 선물" 자동 오픈

* **같은 날 20:00(KST)**: 개인 보관함에서 선물 오픈(기본)
  * (선택) 알림 수신 동의 시 메시지 발송
* 선물 1차는 **스토리북(HTML/PDF)** 우선 (영상은 2차 옵션)

---

## 2) 결과물 정의

### 2-1. 용궁 보관증(이미지) — *현장 즉시 보장 결과물*

반드시 "빠르고 안정적인 방식"으로 생성:

* 기본은 **템플릿 합성**(사진+문구 오버레이)로 99% 성공률 확보
* AI 이미지 생성은 옵션(성공 시 업그레이드), 실패 시 템플릿으로 자동 폴백

**보관증 포함 요소(필수)**

* 소원 한 줄(또는 키워드)
* 날짜/장소(여수)
* "보관 완료" 스탬프 느낌
* 개인 보관함 링크(짧은 URL) 또는 QR
* 공유용 CTA("용궁에 소원 보관 완료")

### 2-2. 디지털 용궁 보관함(웹페이지) — *세계관의 "마무리"*

* 보관된 소원, 보관증, (20:00 이후) 선물 섹션 노출
* 공유 링크 접근 시: 개인정보 노출 없이 "소원/이미지"만 공개되도록 권한 설계

### 2-3. 용궁 선물(20:00 오픈) — *MVP는 스토리북*

* **스토리북(HTML/PDF)**: 사진 + 소원 + 짧은 "용궁의 응원문" (템플릿 기반)
* 영상은 **Phase 2**로 분리 (TTS는 가능하나 현장 즉시 요구와 충돌하므로 야간 배치로)

---

## 3) "아날로그 없이" 안정성 확보: 디지털 폴백(필수)

### 폴백 규칙(우아한 다운그레이드)

1. 사진 업로드 실패/지연 → **[사진 없이 발사]**로 텍스트 보관증 즉시 발급
2. 이미지 생성(고급) 실패 → **템플릿 보관증**으로 자동 대체
3. 네트워크 불안정 → "접수 완료 화면" + 재시도 큐(클라이언트 로컬 저장)
4. 금칙어/부적절 문구 → "소원을 다시 접어주세요(문장 수정 유도)"로 차단

> 원칙: **"아무것도 못 받음" 0건**. 최소 보관증은 100% 제공.

---

## 4) 수신/전환(사업 퍼널) — 강제 수집 금지, '편의'로 유도

보관함에서 선택지 제공:

* (기본) 링크 저장만으로도 20:00에 다시 들어오면 선물 오픈
* (선택) 알림 받기(카톡 채널/문자 등)

메시지 채널(선택 구현)

* 카카오톡 알림톡(가능하면) 또는 SMS
* 개인정보 최소: "알림 동의" 선택한 경우에만 수집/보관(자동 삭제 정책 포함)

---

## 5) 개발 범위(기능 요구사항) — 체크리스트

### 5-1. 프론트(웹)

- [ ] QR 랜딩 페이지: 소원 입력, 사진 업로드, 발사 버튼
- [ ] 소원비행기 애니메이션(진행바)
- [ ] 결과 페이지: 보관증 표시 + 저장/공유 버튼 + 보관함 링크
- [ ] 보관함 페이지: 보관 내용 + 20:00 선물 섹션(시간 전엔 잠금 UI)
- [ ] 폴백 UX: 사진 없이 발사 / 실패 시 즉시 템플릿 제공

### 5-2. 백엔드(API)

- [ ] Wish 생성 API (소원, 사진 메타, 생성 상태 저장)
- [ ] 보관증 생성 API
- [ ] 보관함 조회 API (토큰/slug 기반)
- [ ] 스토리북 생성 잡(20:00 오픈 전 사전 생성 가능)
- [ ] (선택) 알림 발송 스케줄러(20:00 KST)

### 5-3. 데이터 모델(예시)

* Wish: id, slug, wish_text, photo_urls[], created_at, status
* Assets: storage_receipt_url, storybook_url, (optional video_url)
* Consent: notify_opt_in, channel_type, expires_at(자동 삭제)

---

## 6) 비기능 요구사항(행사 서비스 필수)

- [ ] 95% 요청에서 보관증 생성까지 **3분 이내**
- [ ] 서버 로그/모니터링: 실패율(업로드/생성/전송) 대시보드
- [ ] 트래픽 급증 대비: 대기열/큐 기반(즉시 템플릿은 항상 가능)
- [ ] 이미지 파일 경량화(모바일 네트워크 고려)

---

## 7) 배포/운영

* 코드 반영 후 GitHub에 feature 브랜치로 PR
* Render 배포 환경변수 추가/검증
* "행사 모드" feature flag로 온/오프 가능하게 구성

---

## 8) 완료 기준(Acceptance Criteria)

* QR → 소원 입력 → 발사 → **보관증 수신**이 휴대폰에서 끊김 없이 동작
* 보관함 링크가 정상 열리고, 20:00 이후 **스토리북 열람 가능**
* 네트워크/업로드 실패 상황에서도 **최소 보관증은 반드시 발급**
* 운영자 개입 없이도 기본 플로우가 돌아감(0~1명 안내만)

---

## 9) 세계관 문구 고정

* **금지**: "탑승/승차/티켓"
* **사용**: 보관 / 봉인 / 도착 / 용궁 / 소원비행기

---

*작성: 루미 | 승인: 푸르미르 CEO | 2026-02-01*
