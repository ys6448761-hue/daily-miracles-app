🧩 MVP 구현 스펙 v1.0 (Claude Code 실행용)
목표 요약

Week 1: 완주 2트랙 + 팬덤 OS 뼈대

Week 2: 용궁 멘토 엔진 “연결”

Week 4: 자동화·학습으로 복리 시작

🗓️ Week 1 — 팬덤 OS 뼈대 (절대 범위 초과 금지)
1️⃣ 핵심 이벤트 스키마 (필수)
EVENT: SEASON_COMPLETE
- user_id
- season_id
- completed_at
- metadata: { duration_days, completion_rate }

EVENT: YONGGUNG_WISH_COMPLETE
- user_id
- wish_id
- status: HOLD | PASS | REJECT
- submitted_at
- reviewed_at
- reviewer_id


📌 규칙

YONGGUNG_WISH_COMPLETE는 기본 HOLD

PASS는 Peer Proof 이후에만 가능

2️⃣ 역할(Role) & 권한(Permission)
ROLE:
- seed
- record
- season_complete
- messenger
- curator
- guardian
- guide

PERMISSION FLAGS:
- voice_access
- credit_access
- content_access
- stewardship_access


📌 규칙

레벨 개념 ❌

역할은 동시에 여러 개 가질 수 있음

3️⃣ 참여 슬롯 강제 로직

모든 콘텐츠 객체에 필드 추가:

participation_slot:
- type: blank | choice | testimony | delivery | mining
- response_required: true


📌 콘텐츠 게시 조건

participation_slot 없으면 게시 불가

4️⃣ 용궁완주 리포트 & Peer Proof

Self Proof: 리포트 10문항 저장

Peer Proof: 체크리스트 결과 저장

YONGGUNG_REVIEW:
- wish_id
- reviewer_id
- decision: PASS | HOLD | REJECT
- notes

🗓️ Week 2 — 용궁 멘토 엔진 연결
5️⃣ 용궁 카드 프로필 페이지

접근 조건

YONGGUNG_WISH_COMPLETE.status == PASS

구성 섹션

용궁완주 배지

완주한 소원(측정 정보)

증언 1문장

변화(Before→After)

돕는 방식(1개 선택)

연결 버튼

디스클레이머(고정)

📌 금지

가격 / 결제 / 수익 UI 전부 ❌

6️⃣ 멘토–새싹 매칭 로직 (하드 버전)
MATCHING HARD CONDITIONS:
- domain_tag overlap >= 1
- mentoring_style match
- mentor_active_slots > 0
- sensitive_flag == false


슬롯 제한

신규 멘토: 1명

기본: 3명

성과 기반 확장

민감 신호

감지 시 → 자동 HOLD + 운영자 라우팅

🗓️ Week 4 — 자동화 & 학습 (복리 시작)
7️⃣ 상황 태그 & 스크립트 추천
CONTEXT_TAGS: T01 ~ T08
SCRIPT:
- script_id
- context_tag
- text
- active: true/false


태그 감지 → 스크립트 자동 삽입

민감 키워드 → 스크립트 #9 강제

8️⃣ 성과 데이터 수집 (학습용)
MENTOR_METRICS:
- mentor_id
- onboarding_success_rate
- season_completion_rate
- response_time
- report_count


성과 낮은 스크립트 자동 비활성

상위 스크립트 → WINNING_SCRIPT

✅ MVP 성공 조건 (체크리스트)

 시즌완주 이벤트 정상 기록

 용궁완주 HOLD→PASS 흐름 작동

 참여 슬롯 없는 콘텐츠 게시 불가

 용궁 카드에 수익 UI 없음

 민감 신호 자동 차단

 멘토 과부하 없음

📦 Claude Code 전달용 한 줄 패킷

“첨부된 MVP 스펙(v1.0)에 따라 Week1~Week4 순서로 구현한다.
완주 2트랙, 역할 OS, 참여 슬롯 강제, 용궁완주 검증(HOLD→PASS),
멘토 매칭 하드 조건, 민감 신호 차단을 최우선으로 한다.”

아래 **한 메시지 그대로 복붙**해서 Claude Code에게 전달하면 돼. (Week1+Week2 합본 / 범위·DoD·우선순위 포함)

```markdown
# [Aurora5] Claude Code 실행 패킷 v1.0 (Week1~Week2)

목표: Aurora5 팬덤 OS MVP의 핵심(완주 2트랙 + 검증 + 참여 슬롯 강제 + 안전 HOLD + 용궁 카드 + 멘토 매칭)을 Week1~Week2에 구현한다.
원칙: “수익 UI 전면 노출 금지(용궁 카드), 안전(HOLD) 최우선, NSM(시즌완주×유료전환) 직결 구조 유지”.
범위 밖: 정산/수익배분, 고급 학습(WINNING_SCRIPT 자동 비활성), 고급 추천 모델(소프트 점수 고도화), 멀티채널 배포 자동화.

---

## 0) 핵심 결정(DEC 요약)
- NSM = 시즌완주율(7일) × 유료전환율(Trial→Paid)
- 완주 2트랙:
  - A) 시즌완주소원이: `SEASON_COMPLETE` (NSM 직결)
  - B) 용궁완주소원이: `YONGGUNG_WISH_COMPLETE` (HOLD→PASS, 멘토/리더/수익 트랙)
- 역할 OS(정체성): 새싹→기록→시즌완주→전달→채택→수호→길잡이 (다중 역할 허용)
- 콘텐츠는 반드시 참여 슬롯 1개 포함(없으면 게시 불가)
- QA/Gate: PASS/WARN/HOLD/FAIL 중 Week1~2는 최소한 민감 신호 HOLD 강제 구현
- 용궁 카드(NFC) 프로필은 “돈 냄새 0%”(가격/수익/판매 UI 금지)

---

## 1) 데이터/이벤트 스키마 (Week1 Day1)
### 이벤트
EVENT: SEASON_COMPLETE
- user_id, season_id, completed_at
- metadata: { duration_days, completion_rate }

EVENT: YONGGUNG_WISH_COMPLETE
- user_id, wish_id
- status: HOLD | PASS | REJECT (default HOLD)
- submitted_at, reviewed_at, reviewer_id

### 역할/권한
ROLES (multi-assign):
- seed, record, season_complete, messenger, curator, guardian, guide

PERMISSIONS (flags):
- voice_access, credit_access, content_access, stewardship_access
+ mentor flags (Week1 Day4 PASS 시 활성):
- mentor_access, nfc_profile_enabled, referral_code_enabled

---

## 2) Week 1 (D1~D5) 구현 체크리스트 + DoD

### D1: 스키마/CRUD
- 이벤트 2종 테이블/모델/CRUD 구현
- role(다중) / permission flags 모델 구현
DoD:
- 콘솔/테스트로 SEASON_COMPLETE 1건 생성→조회 OK
- YONGGUNG_WISH_COMPLETE 생성 시 status=HOLD 확인
- user roles/permissions 저장/조회 OK

### D2: 참여 슬롯 강제 + 게시 차단
- content에 participation_slot 필드 추가:
  - type: blank|choice|testimony|delivery|mining
  - response_required: true
- publish 시 participation_slot 없으면 서버에서 차단(우회 불가)
DoD:
- slot 없으면 publish 실패(명확한 에러)
- slot 있으면 publish 성공(최소 2종 type으로 실데이터 생성/게시)

### D3: 용궁완주 Self Proof(리포트 10문항) 저장/조회
- yonggung_report(10문항) 저장 + wish_id 연결
- 제출 시 YONGGUNG_WISH_COMPLETE 이벤트 생성/연결(status HOLD 유지)
- 운영 검토 대기 리스트(간단 큐) 제공
DoD:
- report 제출/조회 OK, 이벤트 HOLD 생성 확인
- 운영자가 대기 리스트에서 해당 건 확인 가능

### D4: Peer Proof(동료 검증) + PASS 연결
- yonggung_review 저장: reviewer_id, decision(PASS/HOLD/REJECT), notes
- decision=PASS일 때만 이벤트 status PASS 전환 + mentor flags 활성
- PASS 아니면 멘토 기능 접근 차단
DoD:
- PASS 시 status PASS + mentor flags 최소 2개 활성 확인
- HOLD/REJECT 정책대로 전환/유지 및 접근 차단 확인

### D5: 민감 신호 HOLD 라우팅 + Week1 E2E QA
- 민감 키워드/신호 감지(최소 룰) → 자동 HOLD + 운영/수호 큐 티켓 생성
- E2E 3개:
  1) 새싹→참여 슬롯→(기록)→시즌완주 이벤트 기록
  2) 용궁 리포트 제출→HOLD→Peer PASS→권한 활성
  3) 민감 문구→HOLD+라우팅
DoD:
- 민감 케이스에서 흐름 중단+큐 생성 재현 가능
- 위 E2E 3개 로그/스크린 증빙

---

## 3) Week 2 (D6~D10) 구현 체크리스트 + DoD

### D6: 용궁 카드 페이지 골격 + 접근 제어
- yonggung card route/page 생성
- 접근: YONGGUNG_WISH_COMPLETE.status==PASS만 허용
- 섹션 7개 렌더:
  1) 배지 2) 소원(측정) 3) 증언1문장 4) 변화(B-A)
  5) 돕는 방식(1개) 6) 연결 버튼 7) 디스클레이머(고정)
금지: 가격/수익/판매 UI
DoD:
- PASS만 접근 가능, HOLD/REJECT 차단 메시지 명확
- 7섹션 UI 깨짐 없음, 수익 UI 전무

### D7: 카드 데이터 매핑(리포트→카드)
- report에서 카드 필드 매핑:
  - 소원 제목/기간/달성 기준 요약, 증언1문장, 변화 3칸, 돕는 방식(1개)
- 카드당 소원 1개 고정
- 수정 정책 서버 강제(권장: PASS 후 핵심 기준/증거 수정 불가, 문구 일부만 허용)
DoD:
- PASS 유저의 실제 데이터가 카드에 노출
- wish_id 1개 고정 확인, 수정 정책 우회 불가

### D8: 멘토 풀/슬롯 + 하드 매칭(자동 v0)
- mentor 정의: (용궁완주 PASS) && mentor_enabled=true
- mentor slots: 신규 1, 기본 3
- 새싹 온보딩 최소 입력 5개:
  - domain_tag, goal_1line, mentoring_style, energy(low/med/high), sensitive_flag
- 하드 매칭 조건:
  - domain_tag overlap>=1
  - mentoring_style match
  - mentor_active_slots>0
  - sensitive_flag==false (민감이면 매칭 중단+HOLD 라우팅)
DoD:
- 새싹 1명 등록→멘토 1명 자동 배정(매칭 DB 저장/조회)
- 슬롯 0이면 후보 제외, 배정 시 슬롯 감소

### D9: 거절권/재매칭/반자동 큐(최소)
- 멘토 거절권(24h): 거절 시 다음 후보 자동 배정, 후보 없으면 큐
- 새싹 재매칭: “안 맞아요” 1회 허용(무한 루프 방지)
- 반자동 큐 트리거(최소):
  - 2회 실패 OR energy=low & 48h 무응답 → 운영/수호 큐 생성
DoD:
- 거절→재배정 또는 큐 생성 재현
- 재매칭 1회 동작 재현
- 트리거 발생 시 운영 큐 티켓 생성 재현
- 민감 케이스는 자동 매칭 절대 실행되지 않음

### D10: Week2 통합 QA + 운영 핸드오프
- E2E 4개:
  1) 용궁 PASS→카드 노출
  2) 용궁 HOLD→카드 차단
  3) 새싹→자동 매칭 성공(슬롯 감소)
  4) 거절/재매칭/후보 없음→큐 생성
- 운영자(최소) 큐 화면/리스트:
  - 용궁 검증 대기, 매칭 반자동/실패 대기, 민감 HOLD 대기
DoD:
- 4 시나리오 재현 로그/스크린
- 운영자가 큐 3종을 한 화면에서 찾을 수 있음(최소 리스트)
- Week3/4(태그 스크립트/학습/정산) 없이도 안정 동작

---

## 4) 구현 우선순위(절대)
1) 안전: 민감 신호 HOLD + 라우팅
2) 완주 2트랙 이벤트 + HOLD→PASS
3) 참여 슬롯 강제(게시 차단)
4) 용궁 카드 접근 제어(PASS only) + 돈 냄새 0
5) 하드 매칭 + 슬롯 제한 + 거절/재매칭/큐

---

## 5) 참고(멘토 메시지/카피 원칙)
- “전문가/상담/치료” 톤 금지, “해본 사람/동행” 톤 유지
- 단정어(무조건/반드시/정답) 금지 필터 권장
- 카드 UI에서 가격/수익/판매 유도 요소 금지

끝.
```