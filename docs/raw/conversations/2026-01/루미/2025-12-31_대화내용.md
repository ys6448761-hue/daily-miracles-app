## 🔍 컨텍스트 요약 (다음 창 시작용)

### 1) 현재 프로젝트
- 하루하루의 기적 / Aurora5  
- “카카오/문자 알림(솔라피) 미수신” P0 장애 대응 및 재발 방지 패키지 진행 중

### 2) 지금까지 확정된 내용
- “카톡이 안 옴” 이슈는 **고객용 카톡(알림톡/친구톡)** vs **내부 🔴긴급 알림 카톡** 두 갈래로 점검 필요
- DEC-2025-1230-003 기준: **카카오톡은 🔴긴급 상황에만** 쓰는 구조(일반 요약/정기 메시지는 이메일/노션 등)  
- Solapi 환경변수 점검표 정리 완료:
  - SOLAPI_API_KEY/SECRET(필수), SOLAPI_PFID(알림톡 필수), SOLAPI_SMS_FROM(SMS 필수), SOLAPI_TEMPLATE_*(선택), CRO_PHONE(RED 필수)
- Render 배포 후 점검 플로우 확정:
  1) `/api/notify/status`로 env 상태 확인
  2) `/api/notify/test`로 SMS 테스트 발송
  3) Render 로그에서 `[Solapi]` 로그 확인
- “1899 발신번호”는 **등록/소유 확실하지 않으면 사용 금지**  
  → **SMS 발신번호는 Solapi에 등록된 번호만**(현재 01038196178로 변경)

### 3) 최신 단서 (스크린샷 기반)
- Solapi 메시지 로그에서
  - `API + ATA` 건은 **성공 1** (알림톡은 정상 가능성)
  - `API` 건은 **실패 1, 발송건수 0** (SMS/일반 API 경로 쪽이 실패한 흔적)
- 따라서 “카톡이 안 옴”은 단일 원인이라기보다 **경로별(알림톡 vs SMS)로 성공/실패가 갈림**

### 4) 열린 이슈 (아직 확인 필요)
- 실패한 `API` 건의 **errorCode / errorMessage** 미확인  
  → 이 문구가 나오면 “발신번호(from) 문제 / payload 비어있음 / 수신번호 형식 / 인증/권한” 중 원인이 바로 좁혀짐
- 코드가 실제로 `SOLAPI_SMS_FROM=01038196178`를 참조하고 있는지 불명확
  - 하드코딩(1899 등) 또는 다른 env키(`SENDER_PHONE`) 우선 참조 가능성

### 5) 추천 다음 스텝 (바로 실행)
1) Solapi에서 **실패한 행 클릭 → 메시지목록에서 errorMessage 확인**
2) Render 환경변수:
   - `SOLAPI_SMS_FROM=01038196178` 반영 + 재배포/리스타트
   - `SENDER_PHONE` 쓰는 구조면 동일 번호로 맞추거나 deprec_
