# 📋 Aurora5 Judge 프롬프트 가이드

> LLM-as-a-Judge 시스템의 평가 기준 및 프롬프트 정의

## 📊 5항목 평가 기준

| # | 항목 | 체크 내용 | 점수 |
|---|------|----------|------|
| 1 | 형식 준수 | 루미/재미/코미/주 포맷 지켰나? | 0/1 |
| 2 | 근거성 | docs/raw 어디서 가져왔나? 링크/인용 있나? | 0/1 |
| 3 | 일관성 | 스레드 앞부분 결정과 모순 없나? | 0/1 |
| 4 | 불확실성 표시 | 모르면 TBD/질문으로 처리했나? | 0/1 |
| 5 | 환각 위험 | 없는 사실을 단정하지 않았나? | 0/1 |

**PASS 조건**: 5항목 중 **4개 이상** 충족

---

## 🎭 에이전트별 포맷 기준

### KOMI (코미)
```
📋 [요청 정리]
• 목적: {한 줄 요약}
• 결과물: {구체적 산출물}
• 영향도: {🔴P0/🟡P1/🟢P2}

👥 [추천 담당]
• 담당: {팀원}
• 기한: {YYYY-MM-DD}
• 검증: {완료 조건}

📌 [다음 액션]
{누가 무엇을 언제까지}
```

### LUMI (루미)
```
🔍 [진단]
• 현재 상태: {데이터 기반 현황}
• 문제점: {발견된 이슈}

📊 [지표]
• 핵심 KPI: {측정 항목}
• 목표치: {숫자}
• 임계값: {정상/경고/위험}

💡 [가설]
• {데이터 기반 추론}

🧪 [다음 실험]
• {검증할 내용}
```

### JAEMI (재미)
```
💡 [아이디어]
• 소원이 니즈: {핵심 욕구}
• 핵심 메시지: {한 줄}

✍️ [카피 제안]
• A안: {옵션 1}
• B안: {옵션 2}
• 추천: {선택 + 이유}

📐 [형식]
• 포맷: {이미지/텍스트/영상}
• 톤: {따뜻한/유쾌한/진지한}

🚫 [금지선]
• {브랜드에 맞지 않는 표현}
```

### JU (여의보주/주)
```
✨ [영감]
{짧은 영감 한 줄}

🎯 [행동]
{지금 당장 할 수 있는 한 가지}
```

---

## 🔄 모델 캐스케이드 규칙

| 에이전트 | 기본 모델 | 승급 조건 | 승급 모델 |
|---------|----------|----------|----------|
| 루미 | gpt-4o-mini | Judge Fail | gpt-4o |
| 재미 | gpt-4o-mini | Judge Fail | gpt-4o |
| 코미 | **gpt-4o** | - | - |
| 주 | gpt-4o-mini | Judge Fail | gpt-4o |

---

## 📈 품질 로그 지표

| 지표 | 설명 |
|------|------|
| 승급률 (%) | Judge Fail → 상위 모델 비율 |
| Fail 사유 Top3 | 어떤 항목에서 주로 실패하는지 |
| 다운그레이드 횟수 | 코미가 하위 모델로 내려간 횟수 |
| Final 수정률 (%) | Draft→Final 시 수정 필요했던 비율 |

---

## 🔍 Judge 프롬프트 템플릿

```javascript
const JUDGE_PROMPT = `당신은 Aurora5 팀의 품질 검수 AI입니다.
다음 응답이 5가지 기준을 충족하는지 평가하세요.

## 평가 대상
- 에이전트: ${agentRole}
- 사용자 질문: ${userQuery}
- 응답: ${response}

## 평가 기준 (5항목)
1. 형식 준수: ${agentRole} 표준 포맷을 지켰는가?
2. 근거성: 주장에 근거/인용이 있는가?
3. 일관성: 이전 대화/결정과 모순 없는가?
4. 불확실성: 모르는 것은 TBD/질문으로 표시했는가?
5. 환각 위험: 확인되지 않은 사실을 단정하지 않았는가?

## 출력 (JSON)
{
  "pass": true/false,
  "scores": { "format": 1, "evidence": 1, ... },
  "failReason": "실패 시 주요 사유",
  "suggestion": "개선 제안"
}`;
```

---

## ⚙️ 컨텍스트 압축 (2단계)

### 1단계: 압축 (저비용 모델)
- 입력: 긴 스레드 N개 + docs/raw
- 출력: 800~1500자 구조화 요약
- 모델: gpt-4o-mini

### 2단계: 결정 (상위 모델)
- 입력: 압축본 + STANCE MATRIX + Final 룰
- 출력: 결정문 생성
- 모델: gpt-4o

---

*Version: 1.0*
*Last updated: 2026-01-16*
