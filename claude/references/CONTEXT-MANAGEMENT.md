---
name: Aurora 5 컨텍스트 관리 지침
version: 1.0.0
created: 2025-12-29
source: 최수민님 방식
---

# 컨텍스트 관리 지침

## 핵심 원칙

> Claude의 컨텍스트는 유한하다. 효율적으로 사용하라.

컨텍스트(대화 기록)가 길어지면:
- 응답 품질 저하
- 이전 내용 망각
- 같은 실수 반복
- 작업 미완료

---

## 컨텍스트 부족 증상

### 초기 증상
- AI 응답이 갑자기 짧아짐
- "다시 한번 알려주세요" 요청 증가
- 파일 경로/변수명 혼동

### 심각한 증상
- 이전 대화 내용을 완전히 잊어버림
- 같은 코드/실수를 반복
- 작업 완수 못하고 멈춤
- 엉뚱한 파일을 수정

---

## 대처 방법

### 1. 서브 에이전트로 분리

**언제?**: 독립적인 작업이 여러 개일 때

```
# 잘못된 방식
"파일 10개 전부 읽고 분석해줘"

# 올바른 방식
Task 도구로 서브 에이전트 실행:
- Agent 1: 파일 1-3 분석
- Agent 2: 파일 4-6 분석
- Agent 3: 파일 7-10 분석
→ 결과 통합
```

### 2. 스크립트로 전환

**언제?**: 반복 작업, 데이터 처리, 배치 작업

| 작업 유형 | 스크립트 |
|----------|---------|
| DB 데이터 추출 | `scripts/extract-user-data.ts` |
| 메시지 일괄 발송 | `scripts/send-messages-batch.ts` |
| 백업 | `scripts/backup-database.ts` |

**장점**:
- 컨텍스트 소모 최소화
- 재사용 가능
- 백그라운드 실행 가능

### 3. 새 대화 시작 (컨텍스트 리셋)

**언제?**: 완전히 새로운 주제로 넘어갈 때

**방법**:
1. 현재 작업 상태 저장 (TODO, 진행 중인 파일 등)
2. `/clear` 또는 새 세션 시작
3. 필요한 컨텍스트만 다시 제공

### 4. 요약 기법 활용

**긴 파일 읽기 시**:
```
# 잘못된 방식
"이 1000줄 파일 전체 분석해줘"

# 올바른 방식
"이 파일에서 함수 목록만 추출해줘"
"특정 패턴만 검색해줘"
```

---

## 컨텍스트 효율화 팁

### DO (권장)

1. **파일 경로 재사용**
   ```
   경로: C:/project/src/main.ts
   (이후 "main.ts 파일" 로 참조)
   ```

2. **작업 완료 후 정리**
   - 임시 변수/코드 삭제
   - 불필요한 디버그 로그 제거

3. **명확한 지시**
   ```
   ❌ "이거 고쳐줘"
   ⭕ "server.js 45번째 줄 에러 수정해줘"
   ```

4. **배치 처리**
   - 유사 작업은 묶어서 한번에

### DON'T (피해야 함)

1. 같은 파일 반복 읽기
2. 전체 파일 출력 요청 (필요한 부분만)
3. 이미 완료된 작업 재확인 요청
4. 무의미한 대화 추가

---

## 팀별 컨텍스트 관리

### 코미 (운영)
- 일일 보고서는 스크립트로 생성
- 데이터 분석은 서브 에이전트로 분리

### 재미 (콘텐츠)
- 스토리북 생성은 1권씩 별도 세션
- 이미지 프롬프트는 템플릿 재사용

### 루미 (분석)
- 대용량 데이터는 스크립트로 전처리
- 분석 결과는 JSON 파일로 저장

### Claude Code
- 파일 수정은 Edit 도구 사용 (전체 Write 피함)
- 큰 리팩토링은 단계별 분리

---

## 긴급 복구 절차

컨텍스트 오염 발생 시:

1. **현재 상태 백업**
   ```bash
   git stash
   # 또는 작업 중인 내용 별도 저장
   ```

2. **새 세션 시작**

3. **최소한의 컨텍스트만 제공**
   ```
   "이전 세션에서 server.js 수정 중이었어.
   현재 상태: [간략히]
   남은 작업: [구체적으로]"
   ```

4. **작업 재개**

---

## 관련 파일

- `scripts/extract-user-data.ts` - 데이터 추출 (컨텍스트 절약)
- `scripts/send-messages-batch.ts` - 배치 발송 (컨텍스트 절약)
- `claude/pipelines/` - 복잡한 작업 분리

---

*컨텍스트는 소중한 자원입니다. 현명하게 사용하세요.*
