# 하루하루의 기적 - 프로젝트 컨텍스트

> 이 파일은 Claude Code가 새 세션 시작 시 자동으로 읽습니다.

## 빠른 상황 파악

**최신 상태**: `.claude/AURORA_STATUS.md` 읽기
**일일 로그**: `.claude/logs/` 폴더 확인

## 핵심 정보

| 항목 | 내용 |
|------|------|
| 서비스명 | 하루하루의 기적 (Daily Miracles) |
| CEO | 푸르미르 (이세진) |
| 기술 스택 | Node.js, Express, OpenAI, Solapi |
| 카카오 채널 | @dailymiracles |

## Aurora 5 팀

- **코미** (COO): 총괄 조율
- **재미** (CRO): 소원이 응대, RED 신호 대응
- **루미** (Analyst): 데이터 분석
- **여의보주**: 품질 검수
- **Claude Code**: 기술 구현

## 현재 구현 완료

- [x] 신호등 시스템 (RED/YELLOW/GREEN)
- [x] Solapi 연동 (SMS + 카카오 알림톡)
- [x] 기적지수 계산 (50-100점)
- [x] 소원 ACK 자동 발송

## 핵심 파일

```
routes/wishRoutes.js       - 소원실현 API + 신호등
services/solapiService.js  - 메시지 발송
config/messageTemplates.js - 메시지 템플릿
.claude/AURORA_STATUS.md   - 상세 현황판
```

## 세션 시작 시

1. "AURORA_STATUS.md 읽어봐" 로 상세 현황 파악
2. 또는 "오늘 작업 로그 확인해줘" 로 최근 진행 상황 확인

---

## 자동 적용 시스템

> 아래 시스템은 별도 지시 없이도 항상 자동 적용됩니다.

### 1. 디자인 시스템 (항상 적용)

**참조 파일:** `skills/design-system/designsystem.json`

| 항목 | 값 |
|------|-----|
| Primary | `#9B87F5` (메인 퍼플) |
| Secondary | `#F5A7C6` (핑크/코랄) |
| Accent | `#6E59A5` (딥퍼플) |
| Background | `#FFF5F7` (연핑크) |
| Gradient | `linear-gradient(135deg, #9B87F5, #F5A7C6)` |

**필수 체크:**
- 금지어 목록: `skills/design-system/forbidden-words.json`
- 모든 콘텐츠 생성 전 금지어 체크 수행

### 2. 역순 프롬프트 전략 (콘텐츠 생성 시)

**참조 파일:** `frameworks/stick-principles.json`

**적용 방식:**
```
Step 1: 초안 5개 자유롭게 생성
Step 2: 스틱 6원칙으로 분석
Step 3: 부족한 원리 보완하여 최종본 생성
```

**유틸리티:** `utils/reverseOrderPrompt.js`

**적용 대상:**
- 소원이 응원 메시지
- 마케팅 카피
- 알림톡/SMS 내용

### 3. 브랜드 보이스 (모든 메시지)

**참조 파일:** `skills/design-system/brand-voice.md`

**톤앤매너:**
- 따뜻하지만 전문적
- 희망적이지만 현실적
- 과학적/심리학적 언어 사용

**절대 금지:**
- 사주, 점술, 관상 용어
- 운세, 대운, 궁합 등
- 과도한 약속 ("100% 성공" 등)

### 4. 자동 응답 시스템 (문의 처리 시)

**참조 파일:**
- `utils/inquiryClassifier.js` - 문의 분류
- `services/autoResponseService.js` - 자동 응답

**문의 유형:**
| 유형 | 키워드 | 자동응답 |
|------|--------|---------|
| STATUS | 진행, 상태, 언제 | O |
| RESEND | PDF, 재발송, 다시 | O |
| TRAVEL | 여수, 여행, 견적 | O |
| GENERAL | 기타 | O + 에스컬레이션 |

---

## 작업 시 체크리스트

- [ ] 금지어 체크 완료?
- [ ] 브랜드 컬러 사용?
- [ ] 톤앤매너 준수?
- [ ] 역순 전략 적용? (콘텐츠 생성 시)

---

## 🛡️ 가디언 모드 v2.0 (매 작업 시 필수 실행)

> 모든 작업 완료 후 아래 점검을 자동 수행하고 결과를 보고합니다.
> 이 점검은 생략할 수 없으며, 모든 작업 결과에 포함되어야 합니다.

---

### Part A: 코드 품질 점검

**1. 누락 체크 (Missing)**
- 이 기능과 연결되어야 할 다른 기능은?
- 사용자 플로우에서 빠진 단계는?
- 에러 처리/예외 상황 고려했나?
- 엣지 케이스(빈 값, 잘못된 입력 등) 처리했나?

**2. 연결성 체크 (Connection)**
- 이 기능이 호출하는 다른 함수/API는 존재하나?
- 이 기능을 호출해야 하는 곳에서 실제로 호출하나?
- 데이터 흐름이 끊기는 지점은 없나?

**3. 일관성 체크 (Consistency)**
- 기존 코드 스타일과 일치하나?
- 변수/함수 명명 규칙 준수했나?
- 브랜드 가이드(designsystem.json) 적용했나?
- 다른 파일에서 중복 구현된 기능은 없나?

**4. 품질 체크 (Quality)**
- 에러 로깅 추가했나?
- 성능 이슈 없나? (N+1 쿼리, 불필요한 반복 등)
- 보안 취약점 없나? (SQL 인젝션, XSS 등)
- 모바일 반응형 적용했나? (UI의 경우)

---

### Part B: 시스템 헬스 체크

**매 작업 시 간단 체크:**
- 대용량 파일(5MB+) 새로 생성했나?
- 임시 파일 정리 필요한가?

**임계치 기준:**

| 항목 | 🟢 정상 | 🟡 주의 | 🔴 위험 |
|------|--------|--------|--------|
| 전체 용량 (코드만) | <400MB | 400~500MB | 500MB+ |
| node_modules | <350MB | 350~400MB | 400MB+ |
| 임시 파일 | <50MB | 50~100MB | 100MB+ |
| 단일 파일 | <5MB | 5~10MB | 10MB+ |

**자동 경고 트리거:**
- 🔴 전체 500MB 초과 → 즉시 경고 + 정리 제안
- 🟡 전체 400MB 초과 → 정리 권장
- 🟡 대용량 파일 생성 → 필요성 확인

---

### Part C: 선제적 제안 (필수)

매 작업 완료 시 **최소 2개 이상** 제안:

**제안 카테고리:**
- 🔗 연관 기능: "이것도 함께 구현하면 좋습니다"
- ⚡ 성능 개선: "이렇게 하면 더 빨라집니다"
- 🛡️ 안정성: "이 예외 처리를 추가하세요"
- 🎨 UX 개선: "사용자 경험을 위해 이것도 고려하세요"
- 🧹 정리: "이 파일/폴더 정리하면 X MB 확보됩니다"

---

### Part D: 출력 형식 (필수 준수)

모든 작업 완료 시 아래 형식 사용:

```
═══════════════════════════════════════════════════════
🛡️ 가디언 점검 결과
═══════════════════════════════════════════════════════

✅ 완료된 작업:
- [작업 내용 요약]

📁 생성/수정된 파일:
- [파일 경로]: [변경 내용]

───────────────────────────────────────────────────────
【코드 품질】

🔍 누락 체크: [발견 사항 또는 "✅ 이상 없음"]
🔗 연결성 체크: [발견 사항 또는 "✅ 정상 연결"]
🎨 일관성 체크: [발견 사항 또는 "✅ 가이드 준수"]
⚡ 품질 체크: [발견 사항 또는 "✅ 품질 양호"]

───────────────────────────────────────────────────────
【시스템 헬스】

대용량 파일 생성: [있음/없음]
임시 파일 상태: [정상/정리 필요]
전체 용량 상태: [🟢/🟡/🔴]

───────────────────────────────────────────────────────
💡 선제적 제안:

1. [카테고리] [제안 내용]
   → 이유: [왜 필요한지]

2. [카테고리] [제안 내용]
   → 이유: [왜 필요한지]

═══════════════════════════════════════════════════════
```

---

### Part E: 기능 연결 매트릭스

이 작업을 하면 → 이것도 체크/제안:

| 완료한 작업 | 연관 체크 항목 |
|------------|---------------|
| 새 API 엔드포인트 | 에러 핸들링, 인증, 로깅, API 문서 |
| 새 UI 컴포넌트 | 모바일 반응형, 로딩 상태, 에러 상태 |
| 새 DB 작업 | 트랜잭션, 인덱스, 에러 롤백 |
| 새 메시지/콘텐츠 | 역순 전략 적용, 금지어 체크 |
| 파일 생성 | 용량 체크, 임시 파일 여부 |
| 이미지 처리 | 압축 적용, 정리 필요성 |

---

### 🚨 가디언 경고 트리거

| 상황 | 경고 레벨 | 액션 |
|------|----------|------|
| 에러 처리 없음 | 🟡 주의 | 추가 권장 |
| 기존 기능 충돌 | 🟠 경고 | 수정 필요 |
| 보안 취약점 | 🔴 위험 | 즉시 수정 |
| 브랜드 가이드 위반 | 🟡 주의 | 수정 권장 |
| 사용자 플로우 단절 | 🟠 경고 | 연결 필요 |
| 전체 용량 500MB+ | 🔴 위험 | 즉시 정리 |
| 대용량 파일 10MB+ | 🟡 주의 | 필요성 검토 |

---

*마지막 업데이트: 2025-01-29 (v2.0)*
